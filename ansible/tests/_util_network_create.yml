- name: Create a network
  sf_network:
    netblock: "{{netblock}}"
    name: "{{name}}"
    state: present
  register: network_create_out
  run_once: true

- name: Log result
  debug:
    msg: "{{network_create_out}}"

- name: Determine network uuid
  shell: |
    sf-client --simple network list | grep {{name}} | cut -f 1 -d ","
  register: network_uuid_complex

- name: Extract network uuid
  set_fact:
    "{{name}}_uuid": "{{network_uuid_complex.stdout}}"

- name: Log instance details
  debug:
    msg: Network {{name}} has uuid {{vars[name + '_uuid']}}.
